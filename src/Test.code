FILE :: struct

stdin: @FILE = external
stdout: @FILE = external
stderr: @FILE = external

fputc :: (char: Int, file: @FILE) -> Int

fputs :: (string: @Char, file: @FILE) -> Int

putc :: (char: Char) -> Int {
	return fputc(char as Int, stdout)
}

puts :: (message: @Char) -> Nothing {
	fputs(message, stdout)
	return
}

rfib :: (n: Int) -> Int {
	if (n < 2) {
		return n
	}
	return rfib(n - 1) + rfib(n - 2)
}

lfib :: (n: Int) -> Int {
	if (n < 2) {
		return n
	}
	v_0 := 0
	v_1 := 1
	v_i := v_0 + v_1
	i := 2
	loop {
		if (i == n) {
			return v_i
		}
		v_0 = v_1
		v_1 = v_i
		v_i = v_0 + v_1
		i += 1
	}
}

print_number :: (n: Int) -> Nothing {
	if (n >= 10) {
		print_number(n / 10)
	}
	putc('0' + (n // 10) as Char)
	return
}

String :: struct {
	chars: @Char
	length: Int = 0
}

String :: (chars: @Char) -> String {
	self: String
	self.chars = chars
	self.length = 0
	loop {
		if (chars[self.length] == 0) {
			break
		}
		self.length += 1
	}
	return self
}

Source :: struct {
	content: String
    current_index: Int = 0
    current_line: Int = 1
    current_column: Int = 1
}

main :: () -> Int {
	source: Source
	source.content = String("Hello 2020!")
	puts("Source content: ")
	puts(source.content.chars)
	putc('\n')
	puts("Source content length: ")
	print_number(source.content.length)
	putc('\n')
	puts("Source size: ")
	print_number(size_of Source)
	putc('\n')
	putc('\n')
	i := 0
	loop {
		n := lfib(i)
		print_number(i)
		puts(" - ")
		print_number(n)
		puts(" - ")
		print_number(n // 10)
		putc('\n')
		if (i < 32 && n == rfib(i)) {
			i += 1
		} else {
			break
		}
	}
	return -1
}
